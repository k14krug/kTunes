{% extends 'base.html' %}

{% block title %}{{ tab_name|default('ktunes') }}{% endblock %}


{% block content %}
<style>
  /*kkrug 11/1/2023 Added to control whitespace between rows of all tables initialized by DataTables */
.dataTables_wrapper .dataTable tbody tr {
 line-height: .5; /* Adjust as needed */
}
</style>

  {% include template_name %}

  <div class="pagination">
    <span class="pagination-text">
      {% set start_row = (q_dict['page'] - 1) * q_dict['per_page'] + 1 %}
      {% set end_row = q_dict['page'] * q_dict['per_page'] %}
      {% if end_row > count %}
        {% set end_row = count %}
      {% endif %}
      {{ start_row }}-{{ end_row }} of {{ count }}
    </span>
    {% set args_dict = request.args.to_dict() %}
    {% if q_dict['page'] > 1 %}
      {% set _ = args_dict.update({'page': 1}) %}
      <a href="{{ url_for(endpoint, **args_dict) }}" class="pagination-link">&laquo; First</a>
      {% set _ = args_dict.update({'page': q_dict['page']}) %}
      <a href="{{ url_for(endpoint, **args_dict) }}" class="pagination-link">&lt; Previous</a>
    {% endif %}
    {% for i in range(q_dict['start_page'], q_dict['end_page'] +1 ) %}
      {% if i == q_dict['page'] %}
        <a href="#" class="pagination-link active">{{ i }}</a>
      {% else %}
        {% set _ = args_dict.update({'page': i}) %}
        <a href="{{ url_for(endpoint, **args_dict) }}" class="pagination-link">{{ i }}</a>
      {% endif %}
    {% endfor %}
    {% if q_dict['page'] < q_dict['total_pages'] %}
      {% set _ = args_dict.update({'page': q_dict['page']-1}) %}
      <a href="{{ url_for(endpoint, **args_dict) }}" class="pagination-link">Next &gt;</a>
      {% set _ = args_dict.update({'page': q_dict['total_pages']}) %}
      <a href="{{ url_for(endpoint, **args_dict) }}" class="pagination-link">Last &raquo;</a>
    {% endif %}
  </div>
{% endblock %} 

{% block scripts %}
  <script>
  $(document).ready(function() {
    // Get the per_page value from the Jinja2 template
    var perPage = {{ q_dict['per_page'] }};
    // Initialize DataTables on all tables
    $('table').DataTable({
        "paging": true,
        "sort": false,
        "pageLength": perPage,  // Use the per_page value to set the number of rows to display
        "searching": false,
        "info": false,
        "scrollY": "600px",
        "scrollCollapse": true,
        "dom": 'Bfrtip'
    });
});
</script>
{% endblock %} 